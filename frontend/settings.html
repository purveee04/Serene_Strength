<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serene Strength - Settings</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lobster&family=Pacifico&family=Playwrite+IN:wght@100..400&display=swap"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="settings.css">
</head>

<body>

    <section id="settings-page">
        <a href="index.html" class="back-btn" title="Go Back to Home"><i class="fas fa-arrow-left"></i></a>

        <h1 class="settings-title"><i class="fas fa-cog"></i> Account Settings</h1>

        <div class="settings-card-container">

            <div class="profile-overview">
                <div class="profile-pic-container">
                    <img src="placeholder-profile.jpg" alt="Profile Picture" class="profile-image">
                    <button class="edit-pic-btn" title="Change Profile Picture">
                        <i class="fas fa-camera"></i>
                    </button>
                </div>
                <a href="#" class="edit-profile-link"><i class="fas fa-edit"></i> Edit Profile</a>
            </div>

            <div class="settings-section">
                <h2 class="section-heading">Personal Information</h2>
                <div class="setting-item">
                    <label for="name">Full Name</label>
                    <input type="text" id="name" value="Jane Doe" placeholder="Your full name">
                </div>
                <div class="setting-item">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" value="jane.doe@example.com" placeholder="Your primary email">
                </div>
                <div class="setting-item password-item">
                    <label for="password">Password</label>
                    <div class="password-group">
                        <input type="password" id="password" value="********" readonly>
                        <button class="action-btn-secondary">Change Password</button>
                    </div>
                </div>
                <button class="save-btn"><i class="fas fa-save"></i> Save Profile Changes</button>
            </div>

            <div class="settings-section">
                <h2 class="section-heading">Privacy & Integrations</h2>

                <div class="setting-item setting-toggle-item">
                    <label>Account Visibility</label>
                    <div class="toggle-control-group">
                        <span class="status-label">Private</span>
                        <div class="toggle-switch">
                            <input type="checkbox" id="visibility">
                            <label for="visibility"></label>
                        </div>
                        <span class="status-label">Public</span>
                    </div>
                </div>

                <div class="setting-item setting-integration">
                    <div class="integration-details">
                        <i class="fab fa-spotify spotify-icon"></i>
                        <span class="integration-name">Connect Spotify</span>
                    </div>
                    <a href="https://www.spotify.com/in/account/apps/" target="_blank"
                        class="action-btn-connect">Connect</a>

                    <div class="integration-details">
                        <i class="fab fa-youtube text-red-600"></i>
                        <span class="integration-name">Connect YouTube Music</span>
                    </div>

                    <a href="https://music.youtube.com" target="_blank" class="action-btn-connect">Connect</a>
                </div>



                <div class="setting-item policy-item">
                    <a href="privacypolicy.html" target="_blank" class="policy-link">
                        <i class="fas fa-file-alt"></i> View Privacy Policy
                    </a>
                </div>
            </div>

            <div class="settings-section">
                <h2 class="section-heading">Notifications</h2>

                <div class="setting-item setting-toggle-item">
                    <label>Workout Session Reminders</label>
                    <div class="toggle-switch">
                        <input type="checkbox" id="reminder-notif" checked>
                        <label for="reminder-notif"></label>
                    </div>
                </div>

                <div class="setting-item setting-toggle-item">
                    <label>Personalized AI Coaching Tips</label>
                    <div class="toggle-switch">
                        <input type="checkbox" id="ai-notif" checked>
                        <label for="ai-notif"></label>
                    </div>
                </div>

                <div class="setting-item setting-toggle-item">
                    <label>New Content & Special Offers</label>
                    <div class="toggle-switch">
                        <input type="checkbox" id="offer-notif">
                        <label for="offer-notif"></label>
                    </div>
                </div>
            </div>

            <div class="settings-section subscription-section">
                <h2 class="section-heading">Your Plan</h2>

                <div class="subscription-status">
                    <p class="status-label-current">Current Plan: <span>Serene Strength Premium</span></p>
                    <p class="next-bill">Next Billing Date: **December 1, 2025**</p>
                </div>

                <div class="subscription-actions">
                    <button class="action-btn-primary">
                        <i class="fas fa-arrow-up"></i> Upgrade / Change Plan
                    </button>

                    <button class="action-btn-tertiary" onclick="window.location.href='profile.html'">
                        <i class="fas fa-ban"></i> Cancel Subscription
                    </button>
                </div>

                <div class="settings-section delete-section">
                    <button class="delete-btn" onclick="confirmAndDeleteAccount()">
                        <i class="fas fa-trash-alt"></i> Delete Account
                    </button>
                </div>
    </section>
    <script>
        function confirmAndDeleteAccount() {
            if (!confirm("WARNING: Are you absolutely sure you want to permanently delete your account? This cannot be undone.")) {
                return;
            }

            const authToken = localStorage.getItem("token");

            if (!authToken) {
                alert("Authentication data missing. Please log in.");
                window.location.href = 'login.html';
                return;
            }

            fetch('/api/auth/delete-account', {
                method: 'POST',
                headers: {
                    // Send the JWT
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    alert("Your account has been successfully deleted.");
                    // Clear client-side data
                    localStorage.removeItem('token');
                    localStorage.removeItem('userId');
                    // Redirect
                    window.location.href = 'index.html';
                } else {
                    // Handle errors like 401 (unauthorized)
                    alert("Deletion failed. Please log in and try again.");
                }
            })
            .catch(error => {
                console.error('Error during account deletion:', error);
                alert(`A network error occurred.`);
            });
        }
    </script>

</body>

</html>